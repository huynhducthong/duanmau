<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Trang Order ƒê·ªì ƒÇn</title>
  <link rel="stylesheet" href="./css/order.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" crossorigin="anonymous" />
</head>
<body>
  <h1>Trang Order ƒê·ªì ƒÇn</h1>
  <li class="nav-item">
    <a style="text-decoration: none; color: black; margin: 10px" href="./spck.html"><i class="fa-solid fa-house"></i></a>
    <a style="text-decoration: none; color: black; margin: 10px" href="./balance.html"><i class="fa-solid fa-dollar-sign"></i></a>
  </li>

  <input style="margin: 10px;" type="text" id="search-box" placeholder="T√¨m m√≥n ƒÉn..." oninput="filterMenu()">
  <p>S·ªë d∆∞ v√≠: <span id="wallet-balance">0 VND</span></p>

  <div class="menu"></div>

  <button id="cart-button" onclick="toggleCart()">üõí<span id="cart-badge" class="cart-badge" style="display:none;">0</span></button>

  <div class="cart" id="cart" style="display: none;">
    <h2>Gi·ªè h√†ng</h2>
    <div id="cart-items"></div>
    <p><strong>T·ªïng c·ªông:</strong> <span id="total">0</span> VND</p>
    <button id="checkout-btn" onclick="checkout()">Thanh to√°n</button>
  </div>

  <script>
    const defaultFoods = [
      { name: "B√°nh m√¨", price: 20000, description: "·ªî b√°nh m√¨ gi√≤n ngon", image: "https://media.vov.vn/sites/default/files/styles/large/public/2024-12/cach_an_banh_mi_1.jpg" },
      { name: "Ph·ªü b√≤", price: 50000, description: "T√¥ ph·ªü b√≤ n√≥ng h·ªïi", image: "https://i.ytimg.com/vi/c9GfHgMk1ac/maxresdefault.jpg" },
      { name: "C∆°m chi√™n", price: 35000, description: "C∆°m chi√™n D∆∞∆°ng Ch√¢u", image: "https://image.baophapluat.vn/w840/Uploaded/2025/ycgvptcc/2020_05_28/cach-lam-com-chien-duong-chau-600x481_DLZM.jpg" },
      { name: "C∆°m s∆∞·ªùn", price: 35000, description: "C∆°m s∆∞·ªùn th∆°m ngon", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSAisqlcgi1FcmnumSIixgmVM-rl23sGwOcQg&s" },
      { name: "Ch√°o ƒê·∫≠u ƒê·ªè", price: 20000, description: "Ch√°o ƒë·∫≠u ƒë·ªè b·ªï d∆∞·ª°ng", image: "https://cdn.tgdd.vn/Files/2018/12/03/1135382/3-cach-nau-chao-dau-do--18-760x367.jpg" },
      { name: "B√∫n th·ªãt n∆∞·ªõng", price: 35000, description: "B√∫n th·ªãt n∆∞·ªõng th∆°m ngon", image: "https://danviet.ex-cdn.com/files/f1/upload/1-2015/images/2015-03-24/1434346001-auvmcach-lam-bun-thit-nuong-giadinhvn-233-1010.jpg" },
      { name: "B√∫n ƒë·∫≠u", price: 65000, description: "B√∫n ƒë·∫≠u m·∫Øm t√¥m chu·∫©n v·ªã", image: "https://img.tripi.vn/cdn-cgi/image/width=700,height=700/https://img5.thuthuatphanmem.vn/uploads/2021/11/24/anh-bun-dau-mam-tom-chat-luong-cao_101900877.jpeg" },
      { name: "H·ªß ti·∫øu", price: 20000, description: "H·ªß ti·∫øu n∆∞·ªõc trong, th∆°m ngon", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQflVXe_sCtkuBWr6IZO1Zemc1PYRpJECHFQ&s" },
      { name: "B√°nh m√¨ ph√° l·∫•u", price: 30000, description: "·ªî b√°nh m√¨ ph√° l·∫•u ƒë·∫≠m ƒë√†", image: "https://www.lobanhmi.vn/wp-content/uploads/2024/10/banh-mi-pha-lau.jpg" },
      { name: "Ph·ªü g√†", price: 50000, description: "T√¥ ph·ªü g√† n√≥ng h·ªïi", image: "https://th.bing.com/th/id/OIP.do9xfsOAvwjnom-BRfNTMgHaEL" },
      { name: "C∆°m g√†", price: 40000, description: "C∆°m g√† ngon mi·ªáng", image: "https://static.vinwonders.com/production/com-ga-hue-1.jpg" },
      { name: "C∆°m n·∫Øm", price: 25000, description: "C∆°m n·∫Øm ti·ªán l·ª£i", image: "https://img-global.cpcdn.com/recipes/fca0dc2538317eed/200x200cq70/com-nam-ca-hoi.jpg" },
      { name: "Ch√°o g√†", price: 20000, description: "Ch√°o g√† b·ªï d∆∞·ª°ng", image: "https://static.vinwonders.com/2022/12/chao-ga-da-nang-1.jpg" },
      { name: "B√∫n ch·∫£", price: 35000, description: "B√∫n ch·∫£ H√† N·ªôi", image: "https://bizweb.dktcdn.net/thumb/grande/100/442/328/articles/bun-cha-ha-noi.jpg" },
      { name: "B√∫n b√≤ hu·∫ø", price: 65000, description: "B√∫n b√≤ Hu·∫ø cay n·ªìng", image: "https://eggyolk.vn/wp-content/uploads/2024/06/Cach-nau-Bun-Bo-Hue-tai-nha.jpg" },
      { name: "H·ªß ti·∫øu chay", price: 20000, description: "H·ªß ti·∫øu chay thanh ƒë·∫°m", image: "https://cdn.tgdd.vn/2021/07/CookProduct/HutieuNamVangchay-1200x676.jpg" },
      { name: "B√°nh m√¨ sandwich", price: 45000, description: "B√°nh m√¨ sandwich m·ªÅm ngon", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRgjPUq-4Zqau9DePFc0hbBBPfk837j5mHRQQ&s" },
      { name: "Ph·ªü cu·ªën", price: 45000, description: "Ph·ªü cu·ªën thanh m√°t", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSaYQ6r_PdgnenWp6ml-Kc1gskiJTes-Dq47Q&s" },
      { name: "C∆°m t·∫•m", price: 35000, description: "C∆°m t·∫•m s∆∞·ªùn b√¨ ch·∫£", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTjMTotddbFGWEaQfqkSoBR0DR3jc_oh_S3g&s" },
      { name: "C∆°m lam", price: 35000, description: "C∆°m lam ƒë·∫∑c s·∫£n", image: "https://tse4.mm.bing.net/th/id/OIP.fwsSG7bYoe0pf1WqXV_8bwAAAA?r=0&rs=1&pid=ImgDetMain&o=7&rm=3" },
      { name: "Ch√°o l√≤ng", price: 20000, description: "Ch√°o l√≤ng ƒë·∫≠m v·ªã", image: "https://duonggiahotel.vn/wp-content/uploads/2023/11/anh-bia-quan-chao-long-da-nang.jpg" },
      { name: "B√∫n x√†o", price: 35000, description: "B√∫n x√†o rau c·ªß", image: "https://cdn3.ivivu.com/2020/05/bun-thit-xao-ivivu-1.jpg" },
      { name: "B√∫n ri√™u", price: 55000, description: "B√∫n ri√™u cua ƒë·ªìng", image: "https://static-images.vnncdn.net/files/publish/2023/4/3/bun-rieu-cua-fb-464.jpg" },
      { name: "H·ªß ti·∫øu m·ª±c", price: 80000, description: "H·ªß ti·∫øu m·ª±c ƒë·∫∑c s·∫£n", image: "https://tse4.mm.bing.net/th/id/OIP.TKw1Dt3fC9JMzvDaLabYIwHaE7" }
    ];

let foods = JSON.parse(localStorage.getItem("foods"));
  if (!foods || foods.length === 0) {
    foods = defaultFoods;
    localStorage.setItem("foods", JSON.stringify(foods));
  }

  let container = document.querySelector(".menu");
   // Render adminFoods (n·∫øu c√≥)
  foods.forEach((f, index) => {
    if (!defaultFoods.find(df => df.name === f.name)) { 
      let div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <a href="product.html?type=admin&id=${index}">
          <img src="${f.image}" alt="${f.name}">
          <h3>${f.name}</h3>
        </a>
        <p>${f.price.toLocaleString()} VND</p>
        <button onclick="addToCart('${f.name}', ${f.price})">Th√™m v√†o gi·ªè</button>
      `;
      container.appendChild(div);
    }
  });


  // Render defaultFoods
  defaultFoods.forEach((f, index) => {
    let div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <a href="product.html?type=default&id=${index}">
        <img src="${f.image}" alt="${f.name}">
        <h3>${f.name}</h3>
      </a>
      <p>${f.price.toLocaleString()} VND</p>
      <button onclick="addToCart('${f.name}', ${f.price})">Th√™m v√†o gi·ªè</button>
    `;
    container.appendChild(div);
  });

 
    function filterMenu() {
      const keyword = document.getElementById('search-box').value.toLowerCase();
      document.querySelectorAll('.menu .item').forEach(item => {
        const name = item.querySelector('h3').textContent.toLowerCase();
        item.style.display = name.includes(keyword) ? 'block' : 'none';
      });
    }

    let cart = {};
    let walletBalance = parseFloat(localStorage.getItem('wallet_balance')) || 0;

    function updateBalanceDisplay() {
      document.getElementById('wallet-balance').textContent = walletBalance.toLocaleString() + ' VND';
    }

    function addToCart(name, price) {
      if (cart[name]) cart[name].quantity++;
      else cart[name] = { price, quantity: 1 };
      displayCart(); updateCartBadge();
    }

    function removeFromCart(name) {
      delete cart[name]; displayCart(); updateCartBadge();
    }

    function updateCartBadge() {
      const badge = document.getElementById('cart-badge');
      let totalItems = Object.values(cart).reduce((sum, item) => sum + item.quantity, 0);
      if (totalItems > 0) { badge.textContent = totalItems; badge.style.display = 'flex'; }
      else badge.style.display = 'none';
    }

    function displayCart() {
      const cartItems = document.getElementById('cart-items');
      cartItems.innerHTML = ''; let total = 0;
      for (let name in cart) {
        const item = cart[name]; total += item.price * item.quantity;
        cartItems.innerHTML += `<div class="cart-item">${name} - ${item.price.toLocaleString()} VND x ${item.quantity}<button onclick="removeFromCart('${name}')">X√≥a</button></div>`;
      }
      document.getElementById('total').textContent = total.toLocaleString();
    }

    function toggleCart() {
      const cartDiv = document.getElementById('cart');
      cartDiv.style.display = cartDiv.style.display === 'none' ? 'block' : 'none';
    }

    function checkout() {
      const totalAmount = parseFloat(document.getElementById('total').textContent.replace(/,/g, '')) || 0;
      if (totalAmount === 0) return alert('Gi·ªè h√†ng tr·ªëng!');
      if (walletBalance < totalAmount) return alert('S·ªë d∆∞ v√≠ kh√¥ng ƒë·ªß!');
      walletBalance -= totalAmount;
      localStorage.setItem('wallet_balance', walletBalance);
      alert('Thanh to√°n th√†nh c√¥ng: ' + totalAmount.toLocaleString() + ' VND');
      cart = {}; displayCart(); updateBalanceDisplay(); updateCartBadge(); toggleCart();
    }

    updateBalanceDisplay(); updateCartBadge();
  </script>
</body>
</html>
